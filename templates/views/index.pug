extends ../layouts/default

block content
	- var x = _.uniqBy(restaurants, 'location.state')
	.hero
		.hero--bg
			.hero--content.center.container
				h3
					|Encontre a sua mesa
					br
					|em
					select.browser-default.select
						each city in x
							if city.location.state != 'Lisboa'
								option(value = 'Lisboa') Lisboa
								option(value= city.location.state)= city.location.state
				a#reserv.btn-flat(href='/restaurants/Lisboa') Reservar

	section.restaurants
		.container
			.section--title
				h3 Destaques
			.row
				each rest in restaurants
					if rest.feature
						.col.m6
							.card.small
								.card-image
									img(src= rest.image.url)
									//- img(src='https://source.unsplash.com/category/food/')
									span.card-title.card-title--index= rest.name
								.card-content
									p: small= 'Cozinha: ' + rest.cuisines
								.card-action
									a(href='rest/' + rest.key) Ver Mais
	//-.container: .jumbotron
		img(src='/images/logo.svg', width='160')
		h1 Welcome
		p This is your new <a href='http://keystonejs.com' target='_blank'>KeystoneJS</a> website.
		p It includes the latest versions of
			| <a href='http://getbootstrap.com/' target='_blank'>Bootstrap</a>
			| and <a href='http://www.jquery.com/' target='_blank'>jQuery</a>.
		p Visit the <a href='http://keystonejs.com/guide' target='_blank'>Getting Started</a> guide to learn how to customise it.
		hr
		if user && user.canAccessKeystone
			p
				a(href='/keystone').btn.btn-lg.btn-primary Open the Admin UI
		else
			p We have created a default Admin user for you with the email <strong>user@keystonejs.com</strong> and the password <strong>admin</strong>.
			p
				a(href='/keystone/signin', style='margin-right: 10px').btn.btn-lg.btn-primary Sign in
				|  to use the Admin UI.
		hr
		p Remember to <a href='https://github.com/keystonejs/keystone' target='_blank'>Star KeystoneJS on GitHub</a> and
			| <a href='https://twitter.com/keystonejs' target='_blank'>follow @keystonejs</a> on twitter for updates.
block js
	script.
		$(document).ready(function() {
			$('.select').material_select();
			
			$('.select').on('change', function (e) {
			    var optionSelected = $("option:selected", this);
			    var valueSelected = this.value;
			    $('#reserv').attr('href', '/restaurants/' + convertToSlug(valueSelected));
			    console.log(convertToSlug(valueSelected));
			});

			function convertToSlug(Text) {
			    //return Text.toLowerCase().replace(/[^\w ]+/g,'').replace(/ +/g,'-');
			    return Text;
			}

		});

